<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>GitHub Followers Finder â€” With Error Handling</title>
</head>
<body>
  <div class="card">
    <h2>ðŸ”Ž GitHub Followers Finder</h2>

    <div class="controls">
      <input id="username" type="text" placeholder="Enter GitHub username" aria-label="GitHub username">
      <button id="fetchBtn">Show Followers</button>
    </div>

    <div id="status" class="status small" aria-live="polite"></div>

    <ul id="followersList" aria-live="polite"></ul>
  </div>

  <script>
    const usernameInput = document.getElementById('username');
    const fetchBtn = document.getElementById('fetchBtn');
    const statusEl = document.getElementById('status');
    const followersList = document.getElementById('followersList');
    const githubUsernameRegex = /^(?!-)[A-Za-z0-9-]{1,39}(?<!-)$/;

    function showStatus(message, type = '') {
      statusEl.textContent = message;
      statusEl.className = 'status small' + (type ? ' ' + type : '');
    }

    function clearResults() {
      followersList.innerHTML = '';
    }

    async function fetchFollowers(username) {
      clearResults();
      showStatus('Loading followers...', ''); 

      try {
        const response = await fetch(`https://api.github.com/users/${encodeURIComponent(username)}/followers`);

        if (!response.ok) {
          if (response.status === 404) {
            throw new Error('User not found (404). Please check the username.');
          } else if (response.status === 403) {
            throw new Error('Rate limit reached or access forbidden (403). Try again later.');
          } else {
            throw new Error(`Request failed (status: ${response.status}).`);
          }
        }

        const followers = await response.json();

        if (!Array.isArray(followers) || followers.length === 0) {
          showStatus('No followers found for this user.', 'success');
          return;
        }

        showStatus(`Found ${followers.length} follower(s).`, 'success');

        followers.forEach(f => {
          const li = document.createElement('li');
          li.innerHTML = `
            <img src="${f.avatar_url}" alt="${f.login}'s avatar">
            <div>
              <a href="${f.html_url}" target="_blank" rel="noopener noreferrer">${f.login}</a>
              <div class="small">${f.html_url}</div>
            </div>
          `;
          followersList.appendChild(li);
        });

      } catch (err) {
        console.error('Fetch error:', err);
        showStatus('âš ï¸ ' + err.message, 'error');
      }
    }

    fetchBtn.addEventListener('click', () => {
      const username = usernameInput.value.trim();

      if (!username) {
        showStatus('Please enter a GitHub username.', 'error');
        clearResults();
        return;
      }

      if (!githubUsernameRegex.test(username)) {
        showStatus('Invalid username format. Use 1â€“39 letters, numbers or hyphens. Cannot start/end with hyphen.', 'error');
        clearResults();
        return;
      }

      fetchFollowers(username);
    });

    usernameInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') fetchBtn.click();
    });
  </script>
</body>
</html>
